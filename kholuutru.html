<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>T·∫°o v√† L∆∞u tr·ªØ c√¢u h·ªèi tr·∫Øc nghi·ªám</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      padding: 20px;
      background: #f5f7fa;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .box {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
      flex: 1 1 400px;
      min-width: 300px;
      max-height: 80vh;
      overflow-y: auto;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    input[type="text"]:focus, textarea:focus, select:focus {
      border-color: #007bff;
      outline: none;
    }
    button {
      margin-top: 25px;
      padding: 12px 25px;
      font-size: 16px;
      background: #007bff;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background: #0056b3;
    }
    .question-item {
      border-bottom: 1px solid #eee;
      padding: 12px 0;
    }
    .question-item:last-child {
      border-bottom: none;
    }
    .subject-label {
      font-weight: bold;
      color: #007bff;
      margin-bottom: 6px;
      text-transform: uppercase;
      font-size: 13px;
    }
    .answers {
      margin-top: 6px;
      padding-left: 18px;
    }
    .answer {
      margin-bottom: 4px;
      font-size: 14px;
    }
    .correct {
      font-weight: bold;
      color: green;
    }
    #filterSubject {
      margin-top: 15px;
      padding: 7px 10px;
      font-size: 14px;
      border-radius: 4px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
    }
    @media (max-width: 760px) {
      .container {
        flex-direction: column;
      }
      .box {
        max-height: none;
      }
    }
  </style>
</head>
<body>

  <h1>T·∫°o v√† L∆∞u tr·ªØ c√¢u h·ªèi tr·∫Øc nghi·ªám</h1>

  <div class="container">

    <!-- √î t·∫°o c√¢u h·ªèi -->
    <div class="box">
      <form id="createForm">
        <label for="subject">Ch·ªçn m√¥n h·ªçc:</label>
        <select id="subject" required>
          <option value="" disabled selected>-- Ch·ªçn m√¥n h·ªçc --</option>
          <option value="toan">To√°n</option>
          <option value="van">VƒÉn</option>
          <option value="hoa">H√≥a</option>
          <option value="li">L√Ω</option>
        </select>

        <label for="questionText">N·ªôi dung c√¢u h·ªèi:</label>
        <textarea id="questionText" rows="4" placeholder="Nh·∫≠p c√¢u h·ªèi" required></textarea>
        <button type="button" id="startRecQuestion">üé§ Ghi √¢m c√¢u h·ªèi</button>

        <label>ƒê√°p √°n A:</label>
        <input type="text" id="ansA" placeholder="Nh·∫≠p ƒë√°p √°n A" required />

        <label>ƒê√°p √°n B:</label>
        <input type="text" id="ansB" placeholder="Nh·∫≠p ƒë√°p √°n B" required />

        <label>ƒê√°p √°n C:</label>
        <input type="text" id="ansC" placeholder="Nh·∫≠p ƒë√°p √°n C" required />

        <label>ƒê√°p √°n D:</label>
        <input type="text" id="ansD" placeholder="Nh·∫≠p ƒë√°p √°n D" required />

        <label for="correctAns">Ch·ªçn ƒë√°p √°n ƒë√∫ng:</label>
        <select id="correctAns" required>
          <option value="" disabled selected>-- Ch·ªçn ƒë√°p √°n ƒë√∫ng --</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
        </select>

        <button type="submit">L∆∞u c√¢u h·ªèi</button>
      </form>
    </div>

    <!-- √î l∆∞u tr·ªØ c√¢u h·ªèi -->
    <div class="box">
      <label for="filterSubject"><strong>L·ªçc theo m√¥n h·ªçc:</strong></label>
      <select id="filterSubject">
        <option value="all" selected>T·∫•t c·∫£ m√¥n h·ªçc</option>
        <option value="toan">To√°n</option>
        <option value="van">VƒÉn</option>
        <option value="hoa">H√≥a</option>
        <option value="li">L√Ω</option>
      </select>

      <div id="questionList" style="margin-top: 15px;">
        <!-- Danh s√°ch c√¢u h·ªèi s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
      </div>
    </div>

  </div>

<script>
  const form = document.getElementById('createForm');
  const questionListEl = document.getElementById('questionList');
  const filterSubjectEl = document.getElementById('filterSubject');
  const startRecQuestionBtn = document.getElementById('startRecQuestion');
  const questionText = document.getElementById('questionText');

  function getQuestions(subject) {
    const data = localStorage.getItem('questions_' + subject);
    return data ? JSON.parse(data) : [];
  }

  function saveQuestion(subject, questionObj) {
    const questions = getQuestions(subject);
    questions.push(questionObj);
    localStorage.setItem('questions_' + subject, JSON.stringify(questions));
  }

  function getAllQuestions() {
    const subjects = ['toan', 'van', 'hoa', 'li'];
    let all = [];
    subjects.forEach(sub => {
      const qs = getQuestions(sub);
      qs.forEach(q => {
        q.subject = sub;
        all.push(q);
      });
    });
    return all;
  }

  function subjectName(code) {
    switch(code) {
      case 'toan': return 'To√°n';
      case 'van': return 'VƒÉn';
      case 'hoa': return 'H√≥a';
      case 'li': return 'L√Ω';
      default: return '';
    }
  }

  function renderQuestions(filter) {
    questionListEl.innerHTML = '';

    let questions = (filter === 'all') ? getAllQuestions() : getQuestions(filter).map(q => ({...q, subject: filter}));

    if (questions.length === 0) {
      questionListEl.innerHTML = '<p>Ch∆∞a c√≥ c√¢u h·ªèi n√†o.</p>';
      return;
    }

    questions.forEach((q, index) => {
      const div = document.createElement('div');
      div.className = 'question-item';

      div.innerHTML = `
        <div class="subject-label">${subjectName(q.subject)}</div>
        <div><strong>C√¢u h·ªèi ${index + 1}:</strong> ${q.text}</div>
        <div class="answers">
          <div class="answer">A: ${q.ansA} ${q.correctAns === 'A' ? '<span class="correct">(ƒê√°p √°n ƒë√∫ng)</span>' : ''}</div>
          <div class="answer">B: ${q.ansB} ${q.correctAns === 'B' ? '<span class="correct">(ƒê√°p √°n ƒë√∫ng)</span>' : ''}</div>
          <div class="answer">C: ${q.ansC} ${q.correctAns === 'C' ? '<span class="correct">(ƒê√°p √°n ƒë√∫ng)</span>' : ''}</div>
          <div class="answer">D: ${q.ansD} ${q.correctAns === 'D' ? '<span class="correct">(ƒê√°p √°n ƒë√∫ng)</span>' : ''}</div>
        </div>
      `;

      questionListEl.appendChild(div);
    });
  }

  form.addEventListener('submit', e => {
    e.preventDefault();

    const subject = document.getElementById('subject').value;
    const text = questionText.value.trim();
    const ansA = document.getElementById('ansA').value.trim();
    const ansB = document.getElementById('ansB').value.trim();
    const ansC = document.getElementById('ansC').value.trim();
    const ansD = document.getElementById('ansD').value.trim();
    const correctAns = document.getElementById('correctAns').value;

    if (!subject || !text || !ansA || !ansB || !ansC || !ansD || !correctAns) {
      alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin.');
      return;
    }

    const questionObj = {
      text,
      ansA,
      ansB,
      ansC,
      ansD,
      correctAns
    };

    saveQuestion(subject, questionObj);

    alert('L∆∞u c√¢u h·ªèi th√†nh c√¥ng!');

    form.reset();
    renderQuestions(filterSubjectEl.value);
  });

  filterSubjectEl.addEventListener('change', () => {
    renderQuestions(filterSubjectEl.value);
  });

  // Nh·∫≠n d·∫°ng gi·ªçng n√≥i ph·∫ßn t·∫°o c√¢u h·ªèi
  if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
    startRecQuestionBtn.disabled = true;
    startRecQuestionBtn.textContent = 'Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ nh·∫≠n d·∫°ng gi·ªçng n√≥i';
  } else {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();
    recognition.lang = 'vi-VN';  // Ng√¥n ng·ªØ ti·∫øng Vi·ªát
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    startRecQuestionBtn.addEventListener('click', () => {
      recognition.start();
      startRecQuestionBtn.textContent = 'ƒêang nghe... Nh·∫•n ƒë·ªÉ d·ª´ng';
    });

    recognition.addEventListener('result', (event) => {
      const transcript = event.results[0][0].transcript;
      questionText.value = transcript;
      startRecQuestionBtn.textContent = 'üé§ Ghi √¢m c√¢u h·ªèi';
    });

    recognition.addEventListener('end', () => {
      startRecQuestionBtn.textContent = 'üé§ Ghi √¢m c√¢u h·ªèi';
    });

    recognition.addEventListener('error', (event) => {
      alert('L·ªói khi nh·∫≠n d·∫°ng gi·ªçng n√≥i: ' + event.error);
      startRecQuestionBtn.textContent = 'üé§ Ghi √¢m c√¢u h·ªèi';
    });
  }

  // Hi·ªÉn th·ªã danh s√°ch c√¢u h·ªèi l√∫c ƒë·∫ßu
  renderQuestions('all');
</script>

</body>
</html>
