<!DOCTYPE html>
<html lang="vi">
<head>
 <a href="trangchinh.html">‚Üê Quay v·ªÅ trang ch√≠nh</a>
  <meta charset="UTF-8" />
  <title>‚è∞ G√≥c Nh·∫Øc Nh·ªü</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e6f7ff;
      color: #003366;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h1 {
      color: #0066cc;
    }
    label {
      display: block;
      margin: 12px 0 4px;
      font-weight: bold;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #99ccff;
      font-size: 1rem;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    button {
      margin-top: 15px;
      background-color: #4caf50;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover {
      background-color: #388e3c;
    }
    .reminder-list {
      margin-top: 30px;
    }
    .reminder-item {
      background-color: #ffffff;
      border: 1px solid #99ccff;
      padding: 12px;
      border-radius: 10px;
      margin-bottom: 12px;
      position: relative;
    }
    .reminder-item button.delete-btn {
      position: absolute;
      right: 10px;
      top: 10px;
      background-color: #e74c3c;
      border: none;
      color: white;
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
    }
    .reminder-item button.delete-btn:hover {
      background-color: #c0392b;
    }
  </style>
</head>
<body>

  <h1>‚è∞ G√≥c Nh·∫Øc Nh·ªü</h1>

  <form id="reminder-form">
    <label for="date">Ch·ªçn ng√†y:</label>
    <input type="date" id="date" required />

    <label for="time">Ch·ªçn gi·ªù:</label>
    <input type="time" id="time" required />

    <label for="note">Ghi ch√∫ l·ªùi nh·∫Øc:</label>
    <textarea id="note" placeholder="Nh·∫≠p ghi ch√∫..." required></textarea>

    <button type="submit">üíæ L∆∞u l·ªùi nh·∫Øc</button>
  </form>

  <div class="reminder-list" id="reminder-list">
    <h2>Danh s√°ch l·ªùi nh·∫Øc</h2>
    <!-- L·ªùi nh·∫Øc s·∫Ω hi·ªán ·ªü ƒë√¢y -->
  </div>

  <script>
   const form = document.getElementById('reminder-form');
const list = document.getElementById('reminder-list');

// Y√™u c·∫ßu quy·ªÅn th√¥ng b√°o

if ('Notification' in window) {

if (Notification.permission === 'default') {

Notification.requestPermission();

}

}

// Load danh s√°ch t·ª´ localStorage
function loadReminders() {
  const data = JSON.parse(localStorage.getItem('reminders') || '[]');
  renderReminders(data);
  checkRemindersNotification(data);
}

// L∆∞u danh s√°ch v√†o localStorage
function saveReminders(data) {
  localStorage.setItem('reminders', JSON.stringify(data));
}

// Hi·ªÉn th·ªã danh s√°ch l·ªùi nh·∫Øc
function renderReminders(reminders) {
  // X√≥a h·∫øt ph·∫ßn t·ª≠ hi·ªán c√≥ tr·ª´ ti√™u ƒë·ªÅ
  const existingItems = list.querySelectorAll('.reminder-item');
  existingItems.forEach(item => item.remove());

  if(reminders.length === 0) {
    const p = document.createElement('p');
    p.textContent = "Ch∆∞a c√≥ l·ªùi nh·∫Øc n√†o.";
    list.appendChild(p);
    return;
  }

  reminders.forEach((r, idx) => {
    const div = document.createElement('div');
    div.className = 'reminder-item';

    div.innerHTML = `
      <strong>${r.date} ${r.time}</strong><br/>
      <span>${r.note}</span>
      <button class="delete-btn" title="X√≥a l·ªùi nh·∫Øc">X</button>
    `;

    // X√≥a nh·∫Øc nh·ªü
    div.querySelector('button.delete-btn').onclick = () => {
      reminders.splice(idx, 1);
      saveReminders(reminders);
      renderReminders(reminders);
    };

    list.appendChild(div);
  });
}

// Ki·ªÉm tra v√† th√¥ng b√°o nh·∫Øc nh·ªü
function checkRemindersNotification(reminders) {
  if (Notification.permission !== "granted") {
    return;
  }

  const now = new Date();
  // ... trong h√†m function checkRemindersNotification(reminders) { ...
    // ...
    // Ki·ªÉm tra: N·∫øu th·ªùi gian hi·ªán t·∫°i ƒë√£ ƒê·∫æN ho·∫∑c QUA th·ªùi gian nh·∫Øc
    if (now >= reminderTime) { 
      // Hi·ªÉn th·ªã th√¥ng b√°o
      new Notification("L·ªùi nh·∫Øc", {
        body: `${r.note} (${r.date} ${r.time})`,
        icon: "https://cdn-icons-png.flaticon.com/512/2921/2921823.png"
      });

      // Xo√° l·ªùi nh·∫Øc sau khi th√¥ng b√°o (ƒë·ªÉ kh√¥ng b√°o l·∫°i)
      reminders.splice(idx, 1);
      saveReminders(reminders);
      renderReminders(reminders);
    }
// ...

  reminders.forEach((r, idx) => {
    // T·∫°o Date object t·ª´ ng√†y gi·ªù nh·∫Øc
    const reminderTime = new Date(`${r.date}T${r.time}:00`);

    // N·∫øu nh·∫Øc trong qu√° kh·ª© ho·∫∑c qu√° g·∫ßn (v√≠ d·ª• c√°ch th·ªùi gian hi·ªán t·∫°i < 1 ph√∫t)
    if (now >= reminderTime && now - reminderTime < 60000) {
      // Hi·ªÉn th·ªã th√¥ng b√°o
      new Notification("L·ªùi nh·∫Øc", {
        body: `${r.note} (${r.date} ${r.time})`,
        icon: "https://cdn-icons-png.flaticon.com/512/2921/2921823.png"
      });

      // Xo√° l·ªùi nh·∫Øc sau khi th√¥ng b√°o (ƒë·ªÉ kh√¥ng b√°o l·∫°i)
      reminders.splice(idx, 1);
      saveReminders(reminders);
      renderReminders(reminders);
    }
  });
}

// Ki·ªÉm tra m·ªói 30 gi√¢y
setInterval(() => {
  const reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
  checkRemindersNotification(reminders);
}, 30000);

form.onsubmit = function(e) {
  e.preventDefault();

  const date = form.date.value;
  const time = form.time.value;
  const note = form.note.value.trim();

  if(!date || !time || !note) {
    alert('Vui l√≤ng ƒëi·ªÅn ƒë·ªß th√¥ng tin!');
    return;
  }

  let reminders = JSON.parse(localStorage.getItem('reminders') || '[]');

  reminders.push({date, time, note});

  saveReminders(reminders);
  renderReminders(reminders);

  form.reset();
};

window.onload = loadReminders;

  </script>

</body>
</html>
<a href="trangchinh.html">‚Üê Quay v·ªÅ trang ch√≠nh</a>


